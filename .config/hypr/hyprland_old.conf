
# ------------------------------ Setup  Multi-GPU ------------------------------ #
#https://wiki.hyprland.org/Configuring/Multi-GPU/
env = WLR_DRM_DEVICES,/dev/dri/card1:/dev/dri/card0
env = XCURSOR_SIZE,36
env = HYPRCURSOR_SIZE,36
env = HYPRCURSOR_THEME,catppuccin-mocha-sky-cursors
# ------------------------------ Setup monitors ------------------------------ #
# See https://wiki.hyprland.org/Configuring/Monitors/
monitor=,preferred,auto,auto

# Dual monitor example on G15 Strix
# eDP-1 is the built in monitor while DP-1 is external
# Both monitors here are at 1440 and 165Hz
# DP-1 is on the left and  eDP-1 is on the right
# monitor=HDMI-A-1,2560x1440@60,0x0,1
# monitor=eDP-1,1920x1080@60,2560x360,1
# monitor=eDP-1,disable
# monitor=eDP-1,1920x1080@60,0x0,1

# ------------------------------- Setup Starter ------------------------------ #

# See https://wiki.hyprland.org/Configuring/Keywords/ for more

# Execute your favorite apps at launch

exec-once = ~/.config/hypr/xdg-portal-hyprland
exec-once = dbus-update-activation-environment --systemd WAYLAND_DISPLAY XDG_CURRENT_DESKTOP
exec-once = systemctl --user import-environment WAYLAND_DISPLAY XDG_CURRENT_DESKTOP
exec-once = /usr/lib/polkit-gnome/polkit-kde-authentication-agent-1
exec-once = waybar
exec-once = mako # notifice program
exec-once = ~/.config/hypr/scripts/wall
exec-once = fcitx5 --replace -d # input method
exec-once = wl-paste --type text --watch cliphist store #Stores only text data
exec-once = wl-paste --type image --watch cliphist store #Stores only image data
exec-once = systemctl --user restart pipewire # Restart pipewire to avoid bugs
# exec-once = ~/.config/hypr/scripts/mihomo
# exec-once = udiskie
# exec-once = ~/.config/hypr/scripts/batterytip # waybar is better for battery monitoring
# exec-once = [ ! -s ~/.config/mpd/pid ] && mpd # start mpd service
exec-shutdown = pkill mihomo

# -------------------- Source a file (multi-file configs) -------------------- #
# source = ~/.config/hypr/myColors.conf

# --------------------------- Configuring/Uncommon Tips & Tricks -------------------------- #

# For all categories, see https://wiki.hyprland.org/Configuring/Uncommon-tips--tricks/#switchable-keyboard-layouts
input {
    kb_layout = us
    kb_variant =
    kb_model =
    kb_options =
    kb_rules =
    follow_mouse = 1
    touchpad {
        natural_scroll = true
    }
}

# ---------------------- Configuring/Variables/misc ---------------------- #

misc {
   disable_hyprland_logo = true
   enable_swallow = true
   # vfr = true
   # force_hypr_chan = true
}


# ---------------------- Configuring/Variables/Sections ---------------------- #
# See https://wiki.hyprland.org/Configuring/Variables/#Sections for more


general {
    gaps_in = 3
    gaps_out = 10
    border_size = 4
    # resize_on_border = true
    # extend_border_grab_area = 15 # Optional: extends the area for easier grabbing
    # hover_icon_on_border = true # Optional: shows a cursor icon
    col.active_border = rgb(000000)
    col.inactive_border = rgb(595959)
    layout = dwindle
    # layout = master
}

# ------------------------------- layout config ------------------------------ #
    # See https://wiki.hyprland.org/Configuring/Master-Layout/ for more
master {
    # new_is_master = true
    # no_gaps_when_only = true
    new_on_top = true
}

    # See https://wiki.hyprland.org/Configuring/Dwindle-Layout/ for more
dwindle {
    pseudotile = true # master switch for pseudotiling. Enabling is bound to mainMod + P in the keybinds section below
    preserve_split = true # you probably want this
    # no_gaps_when_only = -1
}

# ------------------------------ gestures config ----------------------------- #
    # See https://wiki.hyprland.org/Configuring/Variables/ for more

gesture = 3, horizontal, workspace, e+1


# ---------------------- Configuring/Variables/decoration ---------------------- #
# See https://wiki.hyprland.org/Configuring/Variables/ for more

decoration {
    rounding = 8
    active_opacity = 0.9
    inactive_opacity = 0.8
    fullscreen_opacity = 0.93

    shadow {
        enabled = false
        range = 4
        render_power = 3
        color = rgba(1a1a1aee)
    }

    # https://wiki.hyprland.org/Configuring/Variables/#blur
    blur {
        enabled = true
        new_optimizations = true
        xray = true
        size = 4
        passes = 2
        vibrancy = 0.1696
    }

    dim_inactive = true
    dim_strength = 0.2
}


# ---------------------- Configuring/Variables/animations ---------------------- #
# Some default animations, see https://wiki.hyprland.org/Configuring/Animations/ for more
animations {
    enabled = true
    bezier = overshot,0.05,0.9,0.1,1.1
    animation = windowsIn, 1, 7, default, popin 80%
    animation = windowsOut, 1, 8, default, popin 80%
    animation = border, 1, 10, default
    animation = fade, 1, 7, default
    animation = workspaces,1,8,default,slide
    animation = specialWorkspace,1,8,default,slide
}

# ---------------------- Configuring/Variables/windowrule ---------------------- #
# See https://wiki.hyprland.org/Configuring/Window-Rules/ for more
# Example windowrule v1
# windowrule = float, ^(kitty)$
# Example windowrule v2
# windowrulev2 = float,class:^(kitty)$,title:^(kitty)$
# rules below would make the specific app transparent

# ---------------------------------------------------------------------------- #
#                                  windowrule                                  #
# ---------------------------------------------------------------------------- #

layerrule = blur on, match:namespace logout_dialog
layerrule = ignore_alpha 0.5,match:namespace waybar
# layerrule = blur, notifications
#layerrule = blur, wallpaper
layerrule = blur_popups on,match:namespace notifications
layerrule = blur on,match:namespace wofi
layerrule = dim_around on,match:namespace wofi
layerrule = no_anim on,match:namespace wofi

# ----------------------------------- kitty ---------------------------------- #
windowrulev2 = animation slidefade,class:^(kitty)$
windowrulev2 = opacity 0.8 0.8,class:^(kitty)$


# ---------------------------------- firefox --------------------------------- #
windowrulev2 = workspace 1, class:^firefox$
windowrulev2 = opacity 0.7 0.7,class:^(firefox)$
windowrulev2 = idleinhibit focus,class:^(firefox)$

# ---------------------------------- vscode ---------------------------------- #
#windowrulev2 = workspace 2, initialTitle:^(Visual Studio Code)$
windowrulev2 = opacity 0.92 0.92,initialTitle:^(Visual Studio Code)$
# windowrulev2 = fullscreen,initialTitle:^(Visual Studio Code)$
windowrulev2 = idleinhibit focus,initialTitle:^(Visual Studio Code)$

# ------------------------------ kitty musicfox ------------------------------ #
windowrulev2 = workspace 3, title:^musicfox$
windowrulev2 = size 1366 950,title:^musicfox$

# ---------------------------------- discord --------------------------------- #
windowrulev2 = workspace 4, class:^WebCord$
windowrulev2 = float,class:^(WebCord)$
windowrulev2 = opacity 0.80 0.80,class:^(WebCord)$
windowrulev2 = idleinhibit focus,class:^(WebCord)$
windowrulev2 = center,class:^(WebCord)$

windowrulev2 = workspace 4,class:^(deepseek)$

windowrulev2 = workspace 5,class:^(mihomoui)$
windowrulev2 = size 1366 950,title:^(Zed — Settings)$
windowrulev2 = opacity 0.95 0.95,class:^(dev.zed.Zed)$

# --------------------------------- telegram --------------------------------- #
windowrulev2 = workspace 6, class:^org.telegram.desktop$
# windowrulev2 = float,class:^(org.telegram.desktop)$
windowrulev2 = opacity 0.95 0.95,class:^(org.telegram.desktop)$
# windowrulev2 = size 1366 950,class:^(org.telegram.desktop)$
windowrulev2 = idleinhibit focus,class:^(org.telegram.desktop)$
windowrulev2 = center,class:^(org.telegram.desktop)$

# ----------------------------------- clash ---------------------------------- #
windowrulev2 = float,class:^(clash-verge)$
windowrulev2 = opacity 0.80 0.80,class:^(clash-verge)$
windowrulev2 = size 1366 950,class:^(clash-verge)$
windowrulev2 = center,class:^(clash-verge)$

# ------------------------------------ mpv ----------------------------------- #
windowrulev2 = idleinhibit focus,class:^(mpv)$
windowrulev2 = float,class:^(mpv)$
windowrulev2 = size 1366 950,class:^(mpv)$
windowrulev2 = center,class:^(mpv)$


# --------------------------------- musikcube -------------------------------- #
windowrulev2 = float,title:^(musikcube)$
windowrulev2 = size 1366 950,title:^(musikcube)$
windowrulev2 = center,title:^(musikcube)$


# ----------------------------------- btop ----------------------------------- #
windowrulev2 = float,title:^(btop)$
windowrulev2 = size 1366 950,title:^(btop)$
windowrulev2 = center,title:^(btop)$

# ------------------------------ kitty yazi   ------------------------------ #
windowrulev2 = float,title:^(yazi)$
windowrulev2 = size 1366 950,title:^(yazi)$
windowrulev2 = center,title:^(yazi)$

# ------------------------------------ imv ----------------------------------- #
windowrulev2 = float,class:^(imv)$
windowrulev2 = center,class:^(imv)$
windowrulev2 = opacity 1.0 1.0,class:^(imv)$


# ----------------------------------- misc ----------------------------------- #

#windowrulev2 = noborder,class:^(wofi)$
windowrulev2 = noanim,class:^(wofi)$
windowrulev2 = rounding 18,class:^(wofi)$
windowrulev2 = opacity 0.9 0.9,class:^(wofi)$

windowrulev2 = noborder,class:^(org.pulseaudio.pavucontrol)$
windowrulev2 = float,class:^(org.pulseaudio.pavucontrol)$
windowrulev2 = opacity 0.9 0.9,class:^(org.pulseaudio.pavucontrol)$
windowrulev2 = size 1280 800,class:^(org.pulseaudio.pavucontrol)$

windowrulev2 = float,class:^(yad)$
windowrulev2 = opacity 0.9 0.9,class:^(yad)$
windowrulev2 = noborder,class:^(yad)$

windowrulev2 = float,class:^(org.kde.polkit-kde-authentication-agent-1)$
windowrulev2 = opacity 0.7 0.7,class:^(org.kde.polkit-kde-authentication-agent-1)$

windowrulev2 = opacity 0.8 0.8,class:^(qt5ct)$

windowrulev2 = float,class:^(thunar)$
windowrulev2 = size 1280 800,class:^(thunar)$
windowrulev2 = center,class:^(thunar)$
windowrulev2 = noborder,class:^(thunar)$
windowrulev2 = opacity 0.8 0.8,class:^(thunar)$

windowrulev2 = float,title:^(Open files)$
windowrulev2 = size 1280 800,title:^(Open files)$
windowrulev2 = center,title:^(Open files)$
windowrulev2 = noborder,title:^(Open files)$
windowrulev2 = opacity 0.8 0.8,title:^(Open files)$


windowrulev2 = float,title:^(Open Folder)$
windowrulev2 = size 1280 800,title:^(Open Folder)$
windowrulev2 = center,title:^(Open Folder)$
windowrulev2 = noborder,title:^(Open Folder)$
windowrulev2 = opacity 0.8 0.8,title:^(Open Folder)$

windowrulev2 = size 1280 900,class:^(download)$


windowrulev2 = size 1280 900,title:^(Open File)$
windowrulev2 = float,title:^(Open File)$
windowrulev2 = center,title:^(Open File)$


windowrulev2 = size 1280 900,title:^(Open file)$
windowrulev2 = float,title:^(Open file)$
windowrulev2 = center,title:^(Open file)$
windowrulev2 = noborder,title:^(Open File)$

windowrulev2 = center,title:^(Save File)$
windowrulev2 = float,title:^(Save File)$
windowrulev2 = noborder,title:^(Save File)$
windowrulev2 = size 1000 800,title:^(Save File)$
windowrulev2 = size 900 700,title:^(Volume Control)$

windowrulev2 = float, title:^([Pp]icture-in-[Pp]icture)$
windowrulev2 = pin, title:^([Pp]icture-in-[Pp]icture)$
windowrulev2 = size 25%, title:^([Pp]icture-in-[Pp]icture)$
windowrulev2 = move 73% 72%, title:^([Pp]icture-in-[Pp]icture)$
windowrulev2 = noborder, title:^([Pp]icture-in-[Pp]icture)$
windowrulev2 = noshadow, title:^([Pp]icture-in-[Pp]icture)$




# --------------------------------- keybinds --------------------------------- #

# Example binds, see https://wiki.hyprland.org/Configuring/Binds/ for more
#bind = SUPER, TAB, overview:toggle # Show the overview
bindd = SUPER, TAB, Toggle Special Workspace, togglespecialworkspace, special:min
bindd = ALT, return, Open Terminal, exec, kitty
bindd = ALT, P,Pin the window, pin, toggle
bindd = ALT, Q,Open foot Terminal,exec,foot
bindd = ALT, F1,Open keybinds,exec,pkill yad || ~/.config/hypr/scripts/binds
bindd = ALT, F2,Open Mihomo ui,exec, bash -c "if ss -tuln | grep -q 1235; then yad --html --browser --uri='http://127.0.0.1:1235' --name=mihomoui; else notify-send 'Please start mihomo... SUPER_SHIFT+M'; fi"
bindd = ALT, W, Close Active Window, killactive
bindd = ALT, C, Pick Color and Copy, exec, hyprpicker -a | cliphist store
bindd = ALT, F4, Show Logout Menu, exec, wlogout --protocol layer-shell
bindd = SUPER, G, Toggle Game Mode, exec, ~/.config/hypr/scripts/gamemod
bindd = ALT, F, Toggle Floating and Resize, exec, hyprctl dispatch togglefloating active && hyprctl dispatch resizeactive exact 1440 850 && hyprctl dispatch centerwindow active
bindd = ALT, SPACE, Launch Applications, exec, pkill wofi || wofi #--normal-window
bindd = ALT, TAB, Switch Applications (Move),exec, ~/.config/hypr/scripts/switch move
bindd = SUPER, SPACE, Switch Applications (Switch), exec, pkill wofi || ~/.config/hypr/scripts/switch switch
bindd = ALT, S, Take Screenshot, exec, ~/.config/hypr/scripts/screenshot
bindd = SUPER SHIFT, R, Reload Hyprland, exec, hyprctl reload
bindd = SUPER, return, Open Deepseek using yad,exec,pkill yad || yad --html --browser --uri="https://chat.deepseek.com" --name=deepseek --class=deepseek
bindd = SUPER, D, Minimize Active Window, exec, ~/.config/hypr/scripts/minimize
bindd = SUPER, B, Open System Monitor, exec, foot --title btop sh -c btop
bindd = SUPER, E, Open File Manager, exec, foot --title yazi sh -c yazi
bindd = SUPER, M, Open Music Player, exec, foot --title musicfox sh -c musicfox
bindd = SUPER, N, Show System Info, exec, foot --hold sh -c neofetch
bindd = SUPER, C, Open Audio Visualizer, exec, foot sh -c cava
bindd = SUPER, L, Lock Screen, exec, swaylock
bindd = SUPER, V, Show Clipboard History, exec, pkill wofi || cliphist list | wofi --dmenu | cliphist decode | wl-copy
bindd = SUPER SHIFT, F4, Exit Hyprland, exit
bindd = SUPER, S, Start Screen Recording, exec, ~/.config/hypr/scripts/record-screen
bindd = SUPER, O, Toggle Window Opacity, exec, hyprctl dispatch setprop "address:$(hyprctl activewindow -j | jq -r '.address')" opaque toggle
bindd = SUPER, F, Toggle Fullscreen, fullscreen
bindd = SUPER SHIFT, M, Open Mihomo UI, exec, ~/.config/hypr/scripts/mihomoui

# 特殊布局绑定
bindd = ALT, D, Toggle Pseudo Mode, pseudo
bindd = ALT, Z, Toggle Split Layout, togglesplit
bindd = SUPER, up, Swap with Next Window, swapnext

# 硬件控制绑定
#bindd = ,F4, Toggle Speaker Mute, exec, pamixer -t
#bindd = ,F5, Decrease Volume 5%, exec, pamixer -d 5
#bindd = ,F6, Increase Volume 5%, exec, pamixer -i 5
#bindd = ,F7, Toggle Microphone Mute, exec, pamixer --default-source -t
#bindd = ,F2, Decrease Brightness 10%, exec, brightnessctl set 10%-
#bindd = ,F3, Increase Brightness 10%, exec, brightnessctl set 10%+

# 窗口焦点移动
$dimOn = hyprctl keyword decoration:dim_inactive true
bindd = CONTROL, left, Move Focus Left, movefocus, l
bindd = CONTROL, right, Move Focus Right, movefocus, r
bindd = CONTROL, up, Move Focus Up, movefocus, u
bindd = CONTROL, down, Move Focus Down, movefocus, d
bind = CONTROL, left, exec, $dimOn
bind = CONTROL, right, exec, $dimOn
bind = CONTROL, up, exec, $dimOn
bind = CONTROL, down, exec, $dimOn



# 工作区切换
bindd = SUPER, 1, Switch to Workspace 1, workspace, 1
bindd = SUPER, 2, Switch to Workspace 2, workspace, 2
bindd = SUPER, 3, Switch to Workspace 3, workspace, 3
bindd = SUPER, 4, Switch to Workspace 4, workspace, 4
bindd = SUPER, 5, Switch to Workspace 5, workspace, 5
bindd = SUPER, 6, Switch to Workspace 6, workspace, 6
bindd = SUPER, 7, Switch to Workspace 7, workspace, 7
bindd = SUPER, 8, Switch to Workspace 8, workspace, 8

# 移动窗口到工作区
bindd = ALT, 1, Move to Workspace 1, movetoworkspace, 1
bindd = ALT, 2, Move to Workspace 2, movetoworkspace, 2
bindd = ALT, 3, Move to Workspace 3, movetoworkspace, 3
bindd = ALT, 4, Move to Workspace 4, movetoworkspace, 4
bindd = ALT, 5, Move to Workspace 5, movetoworkspace, 5
bindd = ALT, 6, Move to Workspace 6, movetoworkspace, 6
bindd = ALT, 7, Move to Workspace 7, movetoworkspace, 7
bindd = ALT, 8, Move to Workspace 8, movetoworkspace, 8

# 工作区滚动切换
bindd = SUPER, left, Next Workspace, workspace, e+1
bindd = SUPER, right, Previous Workspace, workspace, e-1

# 鼠标绑定
binddm = SUPER, mouse:272, Move Window, movewindow
binddm = SUPER, mouse:273, Resize Window, resizewindow

# 窗口大小调整
bindd = CONTROL SHIFT, left, Resize Window Left, resizeactive, -50 0
bindd = CONTROL SHIFT, right, Resize Window Right, resizeactive, 50 0
bindd = CONTROL SHIFT, up, Resize Window Up, resizeactive, 0 -20
bindd = CONTROL SHIFT, down, Resize Window Down, resizeactive, 0 20

# 透明度调整和壁纸切换
bindd = SUPER SHIFT, up, Increase Opacity, exec, ~/.config/hypr/scripts/opacity +
bindd = SUPER SHIFT, down, Decrease Opacity, exec, ~/.config/hypr/scripts/opacity -
bindd = SUPER SHIFT, B, Change Wallpaper, exec, ~/.config/wofi/script/wallpaper.sh
bindd = SUPER SHIFT, V, Custom actions of Clipboard, exec, ~/.config/wofi/script/clip.sh
